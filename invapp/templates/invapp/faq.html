{% extends "invapp/base.html" %}
{% load i18n %}

{% block title %}{% translate "Frequently Asked Questions" %} - InvApp{% endblock %}

{% block extra_head %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {% get_current_language as LANGUAGE_CODE %}
    {% for faq in faqs %}
    {
      "@type": "Question",
      "name": "{% if LANGUAGE_CODE == 'en' and faq.question_en %}{{ faq.question_en|escapejs }}{% else %}{{ faq.question|escapejs }}{% endif %}",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "{% if LANGUAGE_CODE == 'en' and faq.answer_en %}{{ faq.answer_en|striptags|escapejs }}{% else %}{{ faq.answer|striptags|escapejs }}{% endif %}"
      }
    }{% if not forloop.last %},{% endif %}
    {% endfor %}
  ]
}
</script>
{% endblock %}

{% block content %}
<div class="bg-gray-50 dark:bg-gray-900 min-h-screen py-12 px-4 sm:px-6 lg:px-8">
    <div class="max-w-3xl mx-auto">

        <!-- Section Header -->
        <div class="text-center mb-12">
            <h1 class="text-3xl font-extrabold text-gray-900 dark:text-white sm:text-4xl">
                {% translate "Frequently Asked Questions" %}
            </h1>
            <p class="mt-4 text-lg text-gray-500 dark:text-gray-400">
                {% translate "Have questions? Find answers to the most common questions about the InvApp platform." %}
            </p>
        </div>

        <!-- FAQ List (Accordion) -->
        <div class="space-y-4" x-data="{ active: null }">

            {% get_current_language as LANGUAGE_CODE %}

            {% for faq in faqs %}
                <!-- BILINGUAL LOGIC: Select text based on current language -->
                <!-- If on EN and translation exists in DB, use it -->
                {% if LANGUAGE_CODE == 'en' and faq.question_en %}
                    {% with q_text=faq.question_en a_text=faq.answer_en %}
                        {% include "invapp/includes/faq_item.html" %}
                    {% endwith %}
                {% else %}
                    <!-- Fallback: Use default text (Romanian source in DB) -->
                    {% with q_text=faq.question a_text=faq.answer %}
                        {% include "invapp/includes/faq_item.html" %}
                    {% endwith %}
                {% endif %}

            {% empty %}
                <div class="text-center py-10 bg-white dark:bg-gray-800 rounded-lg shadow">
                    <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                        <path vector-effect="non-scaling-stroke" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <p class="mt-2 text-gray-500 dark:text-gray-400">
                        {% translate "No frequently asked questions added yet." %}
                    </p>
                </div>
            {% endfor %}

        </div>

        <!-- Additional CTA -->
        <div class="mt-12 text-center">
            <p class="text-base text-gray-500 dark:text-gray-400">
                {% translate "Didn't find the answer you were looking for?" %}
                <a href="mailto:contact@invapp-romania.ro" class="font-medium text-indigo-600 hover:text-indigo-500 transition duration-150 ease-in-out">
                    {% translate "Contact support team" %} &rarr;
                </a>
            </p>
        </div>

    </div>
</div>

<!-- CSS styles required only for this page -->
<style>
    [x-cloak] { display: none !important; }
</style>
{% endblock %}
